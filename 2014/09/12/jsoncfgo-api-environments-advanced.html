<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Unmarshalling API Servers</title><meta name=description content="Go Golang Code Examples programming"><meta name=viewport content="width=device-width"><link rel="shortcut icon" href=/golang-code-examples/favicon.ico type=image/x-icon><link rel=icon href=/golang-code-examples/favicon.ico type=image/x-icon><link rel=stylesheet href=/golang-code-examples/styles/main.d9bf.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js></script><!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><meta name=viewport content="width=device-width, initial-scale=1, user-scalable=no"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-53073815-1', 'auto');
        ga('send', 'pageview');</script></head><body><div id=dialogoverlay class=dialogoverlay></div><div id=dialogbox class=dialogbox><div><div id=dialogboxhead class=dialogboxhead></div><div id=dialogboxbody class=dialogboxbody></div><div id=dialogboxfoot class=dialogboxfoot></div></div></div><div class=site><header><h1><a class=home-link href="/golang-code-examples">Golang Code Examples</a></h1></header><div id=banner><span id=logo></span> <a href=https://github.com/l3x/golang-code-examples class="button fork"><strong>View On GitHub</strong></a><div class=downloads><span>Downloads:</span><ul><li><a href=https://github.com/l3x/golang-code-examples/zipball/master class=button>ZIP</a></li><li><a href=https://github.com/l3x/golang-code-examples/tarball/master class=button>TAR</a></li></ul></div></div><!-- end banner --><div class=wrapper><nav><ul></ul></nav><div class=page-title><h2>Unmarshalling API Servers</h2><p class=meta>12 Sep 2014</p></div><div class=post><section><h2>Description</h2><p>This example demonstrates two ways to unmarshal a json file that has configuration information describing API servers.</p><p>One technique uses the <strong>&quot;encoding/json&quot;</strong> package.</p><p>The other uses <strong>jsoncfgo</strong> config file reader package.</p><p><br><hr></p><h2>Golang Features</h2><p>This golang code sample demonstrates the following go language features:</p><ul><li>switch</li><li>struct</li><li>slice</li><li>map</li><li>log</li><li>fmt</li><li>basic error handling</li><li>encoding/json</li><li>os.OpenFile</li><li>os.Exit</li></ul><p><br><hr></p><h2>3rd Party Libraries</h2><ul><li>github.com/l3x/jsoncfgo</li><li>github.com/go-goodies/go_utils</li></ul><p>Note that we preface github.com/go-goodies/go_utils with a &quot;u&quot;.</p><p>Now, we can reference go_utils functions like so: <strong>u.Dashes(80)</strong></p><p>Which, by the way, prints 80 dashes to separate sections in our output.</p><p><br><hr></p><h2>Input Files - encoding/json</h2><h3>services<em>json</em>encoding.json</h3><div class=highlight><pre><code class="json language-json" data-lang=json><span class=p>{</span>
   <span class=nt>&quot;development&quot;</span><span class=p>:{</span>
       <span class=nt>&quot;speech&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2051</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2052</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>}</span>
        <span class=p>],</span>
       <span class=nt>&quot;sms&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4050</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4051</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4052</span><span class=p>}</span>
       <span class=p>],</span>
       <span class=nt>&quot;payment&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;payment-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span> <span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2015</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span> <span class=mi>3015</span><span class=p>}</span>
       <span class=p>]</span>
   <span class=p>},</span>
   <span class=nt>&quot;production&quot;</span><span class=p>:{</span>
      <span class=nt>&quot;speech&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3150</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3151</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2051</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3152</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2052</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>}</span>
        <span class=p>],</span>
       <span class=nt>&quot;sms&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4150</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4151</span><span class=p>},</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4152</span><span class=p>}</span>
       <span class=p>],</span>
       <span class=nt>&quot;payment&quot;</span><span class=p>:[</span>
            <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;payment-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span> <span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span> <span class=mi>5050</span><span class=p>}</span>
       <span class=p>]</span>
   <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p><br><hr></p><h2>Code Example - encoding/json</h2><p>In this code example we demonstrate how to use the <strong>&quot;encoding/json&quot;</strong> package:</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span><span class=p>(</span>
    <span class=s>&quot;encoding/json&quot;</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;os&quot;</span>
<span class=p>)</span>

<span class=kd>type</span> <span class=nx>Service</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&quot;name&quot;`</span>
    <span class=nx>Host</span> <span class=kt>string</span> <span class=s>`json:&quot;host&quot;`</span>
    <span class=nx>Port</span> <span class=kt>uint</span> <span class=s>`json:&quot;port&quot;`</span>
    <span class=nx>RestPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;restPort&quot;`</span>
    <span class=nx>WsPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;wsPort&quot;`</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>LoadApiServers</span><span class=p>(</span><span class=nx>filepath</span><span class=p>,</span> <span class=nx>env</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=nx>Service</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>OpenFile</span><span class=p>(</span><span class=nx>filepath</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_RDONLY</span><span class=p>,</span> <span class=mo>0644</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=nx>configs</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=nx>Service</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nx>NewDecoder</span><span class=p>(</span><span class=nx>file</span><span class=p>).</span><span class=nx>Decode</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>configs</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=nx>configs</span><span class=p>[</span><span class=nx>env</span><span class=p>],</span> <span class=nx>err</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>//var configs map[string]map[string][]Service</span>
    <span class=nx>pathToFile</span> <span class=o>:=</span> <span class=s>&quot;/Users/lex/dev/go/samples/src/bitbucket.org/l3x/unmarshal/services-json-encoding.json&quot;</span>

    <span class=nx>dev_configs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>LoadApiServers</span><span class=p>(</span><span class=nx>pathToFile</span><span class=p>,</span> <span class=s>&quot;development&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;dev_configs: %v\n\n&quot;</span><span class=p>,</span> <span class=nx>dev_configs</span><span class=p>)</span>

    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;dev_configs[\&quot;speech\&quot;][2].Name: %v\n&quot;</span><span class=p>,</span> <span class=nx>dev_configs</span><span class=p>[</span><span class=s>&quot;speech&quot;</span><span class=p>][</span><span class=mi>2</span><span class=p>].</span><span class=nx>Name</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;dev_configs[\&quot;sms\&quot;][1].Host: %v\n&quot;</span><span class=p>,</span> <span class=nx>dev_configs</span><span class=p>[</span><span class=s>&quot;sms&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>].</span><span class=nx>Host</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;dev_configs[\&quot;payment\&quot;][0].Port: %v\n&quot;</span><span class=p>,</span> <span class=nx>dev_configs</span><span class=p>[</span><span class=s>&quot;sms&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>].</span><span class=nx>Port</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><hr><h2>Output - encoding/json</h2><pre><code>
dev_configs: map[speech:[{speech-server-1 127.0.0.1 3050 2050 3050} {speech-server-2 127.0.0.1 3051 2051 3051} {speech-server-3 127.0.0.1 3052 2052 3052}] sms:[{sms-server-1 127.0.0.1 4050 0 0} {sms-server-2 127.0.0.1 4051 0 0} {sms-server-3 127.0.0.1 4052 0 0}] payment:[{payment-server-1 127.0.0.1 0 2015 3015}]]

dev_configs["speech"][2].Name: speech-server-3
dev_configs["sms"][1].Host: 127.0.0.1
dev_configs["payment"][0].Port: 4050
<span style=color:blue>
Process finished with exit code 0
</span>
</code></pre><p><br><hr></p><h3>Notes - encoding/json</h3><p>The encoding/json does all the heavy lifting for us.</p><p>All we have to do is 1) Define the struct to contain the unmarshalled json ...</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kd>type</span> <span class=nx>Service</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&quot;name&quot;`</span>
    <span class=nx>Host</span> <span class=kt>string</span> <span class=s>`json:&quot;host&quot;`</span>
    <span class=nx>Port</span> <span class=kt>uint</span> <span class=s>`json:&quot;port&quot;`</span>
    <span class=nx>RestPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;restPort&quot;`</span>
    <span class=nx>WsPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;wsPort&quot;`</span>
<span class=p>}</span>
</code></pre></div><p>... 2) read the json file, 3) allocate space for the map of maps of Service slices and 4) use NewDecoder and Decode to populate our Service structs:</p><div class=highlight><pre><code class="go language-go" data-lang=go>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>OpenFile</span><span class=p>(</span><span class=nx>filepath</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_RDONLY</span><span class=p>,</span> <span class=mo>0644</span><span class=p>)</span>
    <span class=nx>configs</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=nx>Service</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nx>NewDecoder</span><span class=p>(</span><span class=nx>file</span><span class=p>).</span><span class=nx>Decode</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>configs</span><span class=p>)</span>
</code></pre></div><p>This is what NewDecoder and Decode look like under the covers:</p><p><br></p><h4>NewDecoder</h4><div class=highlight><pre><code class="go language-go" data-lang=go><span class=c1>// NewDecoder returns a new decoder that reads from r.</span>
<span class=c1>//</span>
<span class=c1>// The decoder introduces its own buffering and may</span>
<span class=c1>// read data from r beyond the JSON values requested.</span>
<span class=kd>func</span> <span class=nx>NewDecoder</span><span class=p>(</span><span class=nx>r</span> <span class=nx>io</span><span class=p>.</span><span class=nx>Reader</span><span class=p>)</span> <span class=o>*</span><span class=nx>Decoder</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>Decoder</span><span class=p>{</span><span class=nx>r</span><span class=p>:</span> <span class=nx>r</span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p><br></p><h4>Decode</h4><div class=highlight><pre><code class="go language-go" data-lang=go><span class=c1>// Decode reads the next JSON-encoded value from its</span>
<span class=c1>// input and stores it in the value pointed to by v.</span>
<span class=c1>//</span>
<span class=c1>// See the documentation for Unmarshal for details about</span>
<span class=c1>// the conversion of JSON into a Go value.</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>dec</span> <span class=o>*</span><span class=nx>Decoder</span><span class=p>)</span> <span class=nx>Decode</span><span class=p>(</span><span class=nx>v</span> <span class=kd>interface</span><span class=p>{})</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>err</span>
    <span class=p>}</span>

    <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>readValue</span><span class=p>()</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nx>err</span>
    <span class=p>}</span>

    <span class=c1>// Don&#39;t save err from unmarshal into dec.err:</span>
    <span class=c1>// the connection is still usable since we read a complete JSON</span>
    <span class=c1>// object from it before the error happened.</span>
    <span class=nx>dec</span><span class=p>.</span><span class=nx>d</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>dec</span><span class=p>.</span><span class=nx>buf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=nx>n</span><span class=p>])</span>
    <span class=nx>err</span> <span class=p>=</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>d</span><span class=p>.</span><span class=nx>unmarshal</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>

    <span class=c1>// Slide rest of data down.</span>
    <span class=nx>rest</span> <span class=o>:=</span> <span class=nb>copy</span><span class=p>(</span><span class=nx>dec</span><span class=p>.</span><span class=nx>buf</span><span class=p>,</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>buf</span><span class=p>[</span><span class=nx>n</span><span class=p>:])</span>
    <span class=nx>dec</span><span class=p>.</span><span class=nx>buf</span> <span class=p>=</span> <span class=nx>dec</span><span class=p>.</span><span class=nx>buf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=nx>rest</span><span class=p>]</span>

    <span class=k>return</span> <span class=nx>err</span>
<span class=p>}</span>
</code></pre></div><p><br></p><h4>Unmarshal</h4><p>To unmarshal JSON into an interface value, Unmarshal stores one of these in the interface value:</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kt>bool</span><span class=p>,</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>booleans</span>
<span class=kt>float64</span><span class=p>,</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>numbers</span>
<span class=kt>string</span><span class=p>,</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>strings</span>
<span class=p>[]</span><span class=kd>interface</span><span class=p>{},</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>arrays</span>
<span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{},</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>objects</span>
<span class=kc>nil</span> <span class=k>for</span> <span class=nx>JSON</span> <span class=nx>null</span>
</code></pre></div><p>Let&#39;s take another look at the Service struct:</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kd>type</span> <span class=nx>Service</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&quot;name&quot;`</span>
    <span class=nx>Host</span> <span class=kt>string</span> <span class=s>`json:&quot;host&quot;`</span>
    <span class=nx>Port</span> <span class=kt>uint</span> <span class=s>`json:&quot;port&quot;`</span>
    <span class=nx>RestPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;restPort&quot;`</span>
    <span class=nx>WsPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;wsPort&quot;`</span>
<span class=p>}</span>
</code></pre></div><p>Note how each field definition is followed by instructions to encoding/json on how to handle its data.</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=c1>// Field is ignored by this package.</span>
<span class=nx>Field</span> <span class=kt>int</span> <span class=s>`json:&quot;-&quot;`</span>

<span class=c1>// Field appears in JSON as key &quot;myName&quot;.</span>
<span class=nx>Field</span> <span class=kt>int</span> <span class=s>`json:&quot;myName&quot;`</span>

<span class=c1>// Field appears in JSON as key &quot;myName&quot; and</span>
<span class=c1>// the field is omitted from the object if its value is empty,</span>
<span class=c1>// as defined above.</span>
<span class=nx>Field</span> <span class=kt>int</span> <span class=s>`json:&quot;myName,omitempty&quot;`</span>

<span class=c1>// Field appears in JSON as key &quot;Field&quot; (the default), but</span>
<span class=c1>// the field is skipped if empty.</span>
<span class=c1>// Note the leading comma.</span>
<span class=nx>Field</span> <span class=kt>int</span> <span class=s>`json:&quot;,omitempty&quot;`</span>
</code></pre></div><p><br></p><h4>os.OpenFile</h4><p>os.OpenFile is used to read the json file read-only.</p><p><br></p><h4>os.Exit</h4><p>os.Exit causes the current program to exit with the given status code</p><p><br></p><h2>Input Files - jsoncfgo</h2><h3>services_jsoncfgo.json</h3><div class=highlight><pre><code class="json language-json" data-lang=json><span class=p>{</span>
    <span class=nt>&quot;environments&quot;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&quot;development&quot;</span><span class=p>:{</span>
          <span class=nt>&quot;speech&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2051</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2052</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>}</span>
           <span class=p>],</span>
          <span class=nt>&quot;sms&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4050</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4051</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4052</span><span class=p>}</span>
          <span class=p>],</span>
          <span class=nt>&quot;payment&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;payment-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span> <span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2015</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span> <span class=mi>3015</span><span class=p>}</span>
          <span class=p>]</span>
      <span class=p>},</span>
      <span class=nt>&quot;production&quot;</span><span class=p>:{</span>
         <span class=nt>&quot;speech&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3150</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3050</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3151</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2051</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3051</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;speech-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>3152</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2052</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span><span class=mi>3052</span><span class=p>}</span>
           <span class=p>],</span>
          <span class=nt>&quot;sms&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4150</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-2&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4151</span><span class=p>},</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=s2>&quot;sms-server-3&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=mi>4152</span><span class=p>}</span>
          <span class=p>],</span>
          <span class=nt>&quot;payment&quot;</span><span class=p>:[</span>
               <span class=p>{</span><span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;payment-server-1&quot;</span><span class=p>,</span> <span class=nt>&quot;host&quot;</span><span class=p>:</span> <span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span> <span class=nt>&quot;restPort&quot;</span><span class=p>:</span><span class=mi>2050</span><span class=p>,</span> <span class=nt>&quot;wsPort&quot;</span><span class=p>:</span> <span class=mi>5050</span><span class=p>}</span>
          <span class=p>]</span>
      <span class=p>}</span>
   <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p><br><hr></p><h2>Code Example - jsoncfgo</h2><p>In this code example we demonstrate how to use the <strong>&quot;jsoncfgo&quot;</strong> package:</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span><span class=p>(</span>
    <span class=s>&quot;sync&quot;</span>
    <span class=s>&quot;encoding/json&quot;</span>
    <span class=s>&quot;log&quot;</span>
    <span class=s>&quot;os&quot;</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;github.com/l3x/jsoncfgo&quot;</span>
    <span class=nx>u</span> <span class=s>&quot;github.com/go-goodies/go_utils&quot;</span>
    <span class=s>&quot;reflect&quot;</span>
<span class=p>)</span>

<span class=kd>type</span> <span class=nx>Speech</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Services</span> <span class=p>[]</span><span class=nx>Service</span>
<span class=p>}</span>
<span class=kd>type</span> <span class=nx>Sms</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Services</span> <span class=p>[]</span><span class=nx>Service</span>
<span class=p>}</span>
<span class=kd>type</span> <span class=nx>Payment</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Services</span> <span class=p>[]</span><span class=nx>Service</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>Environment</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Speech</span> <span class=kd>interface</span><span class=p>{}</span>
    <span class=nx>Sms</span> <span class=kd>interface</span><span class=p>{}</span>
    <span class=nx>Payment</span> <span class=kd>interface</span><span class=p>{}</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>Service</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&quot;name&quot;`</span>
    <span class=nx>Host</span> <span class=kt>string</span> <span class=s>`json:&quot;host&quot;`</span>
    <span class=nx>Port</span> <span class=kt>uint</span> <span class=s>`json:&quot;port&quot;`</span>
    <span class=nx>RestPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;restPort&quot;`</span>
    <span class=nx>WsPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;wsPort&quot;`</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Services</span> <span class=p>[]</span><span class=nx>Service</span>
    <span class=nx>Master</span> <span class=nx>Service</span>
    <span class=nx>Mutex</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>RWMutex</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>LoadApiServers</span><span class=p>(</span><span class=nx>filepath</span><span class=p>,</span> <span class=nx>env</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=nx>Service</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>OpenFile</span><span class=p>(</span><span class=nx>filepath</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_RDONLY</span><span class=p>,</span> <span class=mo>0644</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nx>configs</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=nx>Service</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nx>NewDecoder</span><span class=p>(</span><span class=nx>file</span><span class=p>).</span><span class=nx>Decode</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>configs</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=nx>configs</span><span class=p>[</span><span class=nx>env</span><span class=p>],</span> <span class=nx>err</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>svcMap</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>(</span><span class=o>*</span><span class=nx>Service</span><span class=p>)</span> <span class=p>{</span>

    <span class=nx>connMap</span> <span class=o>:=</span> <span class=nx>svcMap</span><span class=p>.(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{})</span>
    <span class=nx>connConf</span> <span class=o>:=</span> <span class=nx>jsoncfgo</span><span class=p>.</span><span class=nx>Obj</span><span class=p>(</span><span class=nx>connMap</span><span class=p>)</span>
    <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Service</span><span class=p>{</span>
        <span class=nx>Host</span><span class=p>:</span> <span class=nx>connConf</span><span class=p>.</span><span class=nx>OptionalString</span><span class=p>(</span><span class=s>&quot;host&quot;</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>),</span>
        <span class=nx>Port</span><span class=p>:</span> <span class=nx>connConf</span><span class=p>.</span><span class=nx>OptionalUint</span><span class=p>(</span><span class=s>&quot;port&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
        <span class=nx>RestPort</span><span class=p>:</span> <span class=nx>connConf</span><span class=p>.</span><span class=nx>OptionalUint</span><span class=p>(</span><span class=s>&quot;restPort&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
        <span class=nx>WsPort</span><span class=p>:</span> <span class=nx>connConf</span><span class=p>.</span><span class=nx>OptionalUint</span><span class=p>(</span><span class=s>&quot;wsPort&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=nx>thisSvc</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>printEnvironment</span><span class=p>(</span><span class=nx>envMap</span> <span class=o>*</span><span class=nx>Environment</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>el</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>ValueOf</span><span class=p>(</span><span class=nx>envMap</span><span class=p>).</span><span class=nx>Elem</span><span class=p>()</span>
    <span class=nx>fldName</span> <span class=o>:=</span> <span class=s>&quot;&quot;</span>
    <span class=nx>fldType</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>ValueOf</span><span class=p>(</span><span class=nx>envMap</span><span class=p>).</span><span class=nx>Elem</span><span class=p>().</span><span class=nx>Type</span><span class=p>()</span>
    <span class=kd>var</span> <span class=nx>speech</span> <span class=nx>Speech</span>
    <span class=kd>var</span> <span class=nx>sms</span> <span class=nx>Sms</span>
    <span class=kd>var</span> <span class=nx>payment</span> <span class=nx>Payment</span>
    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>el</span><span class=p>.</span><span class=nx>NumField</span><span class=p>();</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
        <span class=nx>f</span> <span class=o>:=</span> <span class=nx>el</span><span class=p>.</span><span class=nx>Field</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
        <span class=nx>fldName</span> <span class=p>=</span> <span class=nx>fldType</span><span class=p>.</span><span class=nx>Field</span><span class=p>(</span><span class=nx>i</span><span class=p>).</span><span class=nx>Name</span>
        <span class=nx>thisValAry</span> <span class=o>:=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>Interface</span><span class=p>().([]</span><span class=kd>interface</span><span class=p>{})</span>
        <span class=k>switch</span> <span class=nx>fldName</span> <span class=p>{</span>
        <span class=k>case</span> <span class=s>&quot;Speech&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>connectorMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
                <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>connectorMap</span><span class=p>)</span>
                <span class=nx>speech</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>speech</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=k>case</span> <span class=s>&quot;Sms&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>chatMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
                <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>chatMap</span><span class=p>)</span>
                <span class=nx>sms</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>sms</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=k>case</span> <span class=s>&quot;Payment&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>gatetMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
                <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>gatetMap</span><span class=p>)</span>
                <span class=nx>payment</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>payment</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=nx>environment</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Environment</span><span class=p>{</span>
        <span class=nx>Speech</span><span class=p>:</span> <span class=nx>speech</span><span class=p>,</span>
        <span class=nx>Sms</span><span class=p>:</span> <span class=nx>sms</span><span class=p>,</span>
        <span class=nx>Payment</span><span class=p>:</span> <span class=nx>payment</span><span class=p>,</span>
    <span class=p>}</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;environment: %+v\n&quot;</span><span class=p>,</span> <span class=nx>environment</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>pathToFile</span> <span class=o>:=</span> <span class=s>&quot;/Users/lex/dev/go/samples/src/bitbucket.org/l3x/unmarshal/services_jsoncfgo.json&quot;</span>

    <span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>jsoncfgo</span><span class=p>.</span><span class=nx>ReadFile</span><span class=p>(</span><span class=nx>pathToFile</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nx>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>.</span><span class=nx>Error</span><span class=p>())</span>  <span class=c1>// Handle error here</span>
    <span class=p>}</span>

    <span class=nx>environmentsList</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=nx>Environment</span><span class=p>)</span>
    <span class=nx>environments</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>OptionalObject</span><span class=p>(</span><span class=s>&quot;environments&quot;</span><span class=p>)</span>

    <span class=k>for</span> <span class=nx>alias</span><span class=p>,</span> <span class=nx>envMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>environments</span> <span class=p>{</span>

        <span class=nx>servicesMap</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>envMap</span><span class=p>.(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{})</span>
        <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nx>Fatalf</span><span class=p>(</span><span class=s>&quot;entry %q in environments section is a %T, want an object&quot;</span><span class=p>,</span> <span class=nx>alias</span><span class=p>,</span> <span class=nx>envMap</span><span class=p>)</span>
        <span class=p>}</span>
        <span class=nx>servicesConf</span> <span class=o>:=</span> <span class=nx>jsoncfgo</span><span class=p>.</span><span class=nx>Obj</span><span class=p>(</span><span class=nx>servicesMap</span><span class=p>)</span>

        <span class=nx>environment</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Environment</span><span class=p>{</span>
            <span class=nx>Speech</span><span class=p>:</span>   <span class=nx>servicesConf</span><span class=p>[</span><span class=s>&quot;speech&quot;</span><span class=p>],</span>
            <span class=nx>Sms</span><span class=p>:</span>   <span class=nx>servicesConf</span><span class=p>[</span><span class=s>&quot;sms&quot;</span><span class=p>],</span>
            <span class=nx>Payment</span><span class=p>:</span>  <span class=nx>servicesConf</span><span class=p>[</span><span class=s>&quot;payment&quot;</span><span class=p>],</span>
        <span class=p>}</span>
        <span class=nx>environmentsList</span><span class=p>[</span><span class=nx>alias</span><span class=p>]</span> <span class=p>=</span> <span class=nx>environment</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;environment.Speech: %v\n&quot;</span><span class=p>,</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Speech</span><span class=p>)</span>
        <span class=nx>speechAry</span> <span class=o>:=</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Speech</span><span class=p>.([]</span><span class=kd>interface</span><span class=p>{})</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;speechAry[0]: %v\n&quot;</span><span class=p>,</span> <span class=nx>speechAry</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;speechAry[1]: %v\n&quot;</span><span class=p>,</span> <span class=nx>speechAry</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;speechAry[2]: %v\n\n&quot;</span><span class=p>,</span> <span class=nx>speechAry</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>

        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;environment.Sms: %v\n&quot;</span><span class=p>,</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Sms</span><span class=p>)</span>
        <span class=nx>smsAry</span> <span class=o>:=</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Sms</span><span class=p>.([]</span><span class=kd>interface</span><span class=p>{})</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;smsAry[0]: %v\n&quot;</span><span class=p>,</span> <span class=nx>smsAry</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;smsAry[1]: %v\n&quot;</span><span class=p>,</span> <span class=nx>smsAry</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;smsAry[2]: %v\n\n&quot;</span><span class=p>,</span> <span class=nx>smsAry</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>

        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;environment.Payment: %v\n&quot;</span><span class=p>,</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Payment</span><span class=p>)</span>
        <span class=nx>paymentAry</span> <span class=o>:=</span> <span class=nx>environment</span><span class=p>.</span><span class=nx>Payment</span><span class=p>.([]</span><span class=kd>interface</span><span class=p>{})</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;paymentAry[0]: %v\n&quot;</span><span class=p>,</span> <span class=nx>paymentAry</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Dashes</span><span class=p>(</span><span class=mi>80</span><span class=p>))</span>
    <span class=p>}</span>

    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Dashes</span><span class=p>(</span><span class=mi>80</span><span class=p>))</span>
    <span class=k>for</span> <span class=nx>alias</span><span class=p>,</span> <span class=nx>envMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>environmentsList</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;alias: %v\n&quot;</span><span class=p>,</span> <span class=nx>alias</span><span class=p>)</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;envMap: %v\n&quot;</span><span class=p>,</span> <span class=nx>envMap</span><span class=p>)</span>
        <span class=nx>printEnvironment</span><span class=p>(</span><span class=nx>envMap</span><span class=p>)</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Dashes</span><span class=p>(</span><span class=mi>80</span><span class=p>))</span>
    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div><p><br><hr></p><h2>Output - jsoncfgo</h2><pre><code>
environment.Speech: [map[port:3050 restPort:2050 wsPort:3050 name:speech-server-1 host:127.0.0.1] map[restPort:2051 wsPort:3051 name:speech-server-2 host:127.0.0.1 port:3051] map[name:speech-server-3 host:127.0.0.1 port:3052 restPort:2052 wsPort:3052]]
speechAry[0]: map[wsPort:3050 name:speech-server-1 host:127.0.0.1 port:3050 restPort:2050]
speechAry[1]: map[name:speech-server-2 host:127.0.0.1 port:3051 restPort:2051 wsPort:3051]
speechAry[2]: map[name:speech-server-3 host:127.0.0.1 port:3052 restPort:2052 wsPort:3052]

environment.Sms: [map[name:sms-server-1 host:127.0.0.1 port:4050] map[name:sms-server-2 host:127.0.0.1 port:4051] map[host:127.0.0.1 port:4052 name:sms-server-3]]
smsAry[0]: map[name:sms-server-1 host:127.0.0.1 port:4050]
smsAry[1]: map[port:4051 name:sms-server-2 host:127.0.0.1]
smsAry[2]: map[name:sms-server-3 host:127.0.0.1 port:4052]

environment.Payment: [map[name:payment-server-1 host:127.0.0.1 restPort:2015 wsPort:3015]]
paymentAry[0]: map[wsPort:3015 name:payment-server-1 host:127.0.0.1 restPort:2015]
--------------------------------------------------------------------------------
environment.Speech: [map[host:127.0.0.1 port:3150 restPort:2050 wsPort:3050 name:speech-server-1] map[name:speech-server-2 host:127.0.0.1 port:3151 restPort:2051 wsPort:3051] map[port:3152 restPort:2052 wsPort:3052 name:speech-server-3 host:127.0.0.1]]
speechAry[0]: map[wsPort:3050 name:speech-server-1 host:127.0.0.1 port:3150 restPort:2050]
speechAry[1]: map[name:speech-server-2 host:127.0.0.1 port:3151 restPort:2051 wsPort:3051]
speechAry[2]: map[name:speech-server-3 host:127.0.0.1 port:3152 restPort:2052 wsPort:3052]

environment.Sms: [map[name:sms-server-1 host:127.0.0.1 port:4150] map[name:sms-server-2 host:127.0.0.1 port:4151] map[name:sms-server-3 host:127.0.0.1 port:4152]]
smsAry[0]: map[host:127.0.0.1 port:4150 name:sms-server-1]
smsAry[1]: map[name:sms-server-2 host:127.0.0.1 port:4151]
smsAry[2]: map[name:sms-server-3 host:127.0.0.1 port:4152]

environment.Payment: [map[restPort:2050 wsPort:5050 name:payment-server-1 host:127.0.0.1]]
paymentAry[0]: map[name:payment-server-1 host:127.0.0.1 restPort:2050 wsPort:5050]
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
alias: development
envMap: &{[map[host:127.0.0.1 port:3050 restPort:2050 wsPort:3050 name:speech-server-1] map[port:3051 restPort:2051 wsPort:3051 name:speech-server-2 host:127.0.0.1] map[restPort:2052 wsPort:3052 name:speech-server-3 host:127.0.0.1 port:3052]] [map[host:127.0.0.1 port:4050 name:sms-server-1] map[port:4051 name:sms-server-2 host:127.0.0.1] map[name:sms-server-3 host:127.0.0.1 port:4052]] [map[host:127.0.0.1 restPort:2015 wsPort:3015 name:payment-server-1]]}
environment: &{Speech:{Services:[{Name: Host:127.0.0.1 Port:3050 RestPort:2050 WsPort:3050} {Name: Host:127.0.0.1 Port:3051 RestPort:2051 WsPort:3051} {Name: Host:127.0.0.1 Port:3052 RestPort:2052 WsPort:3052}]} Sms:{Services:[{Name: Host:127.0.0.1 Port:4050 RestPort:0 WsPort:0} {Name: Host:127.0.0.1 Port:4051 RestPort:0 WsPort:0} {Name: Host:127.0.0.1 Port:4052 RestPort:0 WsPort:0}]} Payment:{Services:[{Name: Host:127.0.0.1 Port:0 RestPort:2015 WsPort:3015}]}}
--------------------------------------------------------------------------------
alias: production
envMap: &{[map[name:speech-server-1 host:127.0.0.1 port:3150 restPort:2050 wsPort:3050] map[restPort:2051 wsPort:3051 name:speech-server-2 host:127.0.0.1 port:3151] map[host:127.0.0.1 port:3152 restPort:2052 wsPort:3052 name:speech-server-3]] [map[port:4150 name:sms-server-1 host:127.0.0.1] map[name:sms-server-2 host:127.0.0.1 port:4151] map[name:sms-server-3 host:127.0.0.1 port:4152]] [map[name:payment-server-1 host:127.0.0.1 restPort:2050 wsPort:5050]]}
environment: &{Speech:{Services:[{Name: Host:127.0.0.1 Port:3150 RestPort:2050 WsPort:3050} {Name: Host:127.0.0.1 Port:3151 RestPort:2051 WsPort:3051} {Name: Host:127.0.0.1 Port:3152 RestPort:2052 WsPort:3052}]} Sms:{Services:[{Name: Host:127.0.0.1 Port:4150 RestPort:0 WsPort:0} {Name: Host:127.0.0.1 Port:4151 RestPort:0 WsPort:0} {Name: Host:127.0.0.1 Port:4152 RestPort:0 WsPort:0}]} Payment:{Services:[{Name: Host:127.0.0.1 Port:0 RestPort:2050 WsPort:5050}]}}
--------------------------------------------------------------------------------
<span style=color:blue>
Process finished with exit code 0
</span>
</code></pre><p><br><hr></p><h2>Notes</h2><p>We define a struct to contain our environments (&quot;development&quot; and &quot;production&quot;):</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kd>type</span> <span class=nx>Environment</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Speech</span> <span class=kd>interface</span><span class=p>{}</span>
    <span class=nx>Sms</span> <span class=kd>interface</span><span class=p>{}</span>
    <span class=nx>Payment</span> <span class=kd>interface</span><span class=p>{}</span>
<span class=p>}</span>
</code></pre></div><p>... and the familiar Service struct:</p><div class=highlight><pre><code class="go language-go" data-lang=go><span class=kd>type</span> <span class=nx>Service</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&quot;name&quot;`</span>
    <span class=nx>Host</span> <span class=kt>string</span> <span class=s>`json:&quot;host&quot;`</span>
    <span class=nx>Port</span> <span class=kt>uint</span> <span class=s>`json:&quot;port&quot;`</span>
    <span class=nx>RestPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;restPort&quot;`</span>
    <span class=nx>WsPort</span> <span class=kt>uint</span> <span class=s>`json:&quot;wsPort&quot;`</span>
<span class=p>}</span>
</code></pre></div><p>jsconfgo handles the unmarshalling; However, to access individual elements we must use reflection, type assertion and a switch:</p><div class=highlight><pre><code class="go language-go" data-lang=go>    <span class=nx>el</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>ValueOf</span><span class=p>(</span><span class=nx>envMap</span><span class=p>).</span><span class=nx>Elem</span><span class=p>()</span>
    <span class=nx>fldType</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>ValueOf</span><span class=p>(</span><span class=nx>envMap</span><span class=p>).</span><span class=nx>Elem</span><span class=p>().</span><span class=nx>Type</span><span class=p>()</span>
  <span class=nx>thisValAry</span> <span class=o>:=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>Interface</span><span class=p>().([]</span><span class=kd>interface</span><span class=p>{})</span>   
  <span class=c1>// . . .</span>
  <span class=k>switch</span> <span class=nx>fldName</span> <span class=p>{</span>
  <span class=k>case</span> <span class=s>&quot;Speech&quot;</span><span class=p>:</span>
    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>connectorMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
      <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>connectorMap</span><span class=p>)</span>
      <span class=nx>speech</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>speech</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
    <span class=p>}</span>
  <span class=k>case</span> <span class=s>&quot;Sms&quot;</span><span class=p>:</span>
    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>chatMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
      <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>chatMap</span><span class=p>)</span>
      <span class=nx>sms</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>sms</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
    <span class=p>}</span>
  <span class=k>case</span> <span class=s>&quot;Payment&quot;</span><span class=p>:</span>
    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>gatetMap</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>thisValAry</span> <span class=p>{</span>
      <span class=nx>thisSvc</span> <span class=o>:=</span> <span class=nx>getService</span><span class=p>(</span><span class=nx>gatetMap</span><span class=p>)</span>
      <span class=nx>payment</span><span class=p>.</span><span class=nx>Services</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>payment</span><span class=p>.</span><span class=nx>Services</span><span class=p>,</span> <span class=o>*</span><span class=nx>thisSvc</span><span class=p>)</span>
    <span class=p>}</span>
</code></pre></div><p><br></p><h2>Summary</h2><p>Given the format of the json data and our requirements, using the <strong>encoding/json</strong> is the better choice.</p><p>Use <strong>jsoncfgo</strong> when...</p><ul><li>You just need the values from the config file</li><li>You want to perform validation (without extra coding effort)</li><li>You want to be able to indicate which config file values are required or optional</li></ul><p>Use <strong>encoding/json</strong> when...</p><ul><li>You want to unmarshal the json data into a struct so you can access it&#39;s members more easily</li></ul><p><br><hr></p><h2>References</h2><ul><li><a href=https://github.com/l3x/golang-code-examples>Golang Code Examples</a></li><li><a href=https://github.com/l3x/jsoncfgo>jsconfgo package</a></li><li><a href=http://l3x.github.io/golang-code-examples/2014/07/24/jsoncfgo-config-file-reader.html>jsoncfgo - JSON File Reader</a></li><li>[jsoncfgo - Advanced Usage] (http://l3x.github.io/golang-code-examples/2014/07/25/jsoncfgo-config-file-reader-advanced.html_</li><li><a href="http://golang.org/pkg/encoding/json/">encoding/json</a></li><li><a href="http://golang.org/pkg/reflect/">reflect</a></li><li><a href=http://golang.org/pkg/os/#OpenFile>os.OpenFile</a></li><li><a href=http://golang.org/pkg/os/#Exit>os.Exit</a></li><li><a href=http://blog.golang.org/error-handling-and-go>Error handling and Go</a></li><li><a href="http://golang.org/pkg/strings/#Repeat/">String Package&#39;s Repeat Function</a></li><li><a href="http://tour.golang.org/">Golang Tour</a></li></ul></section></div><!-- Add Disqus comments. --><div id=disqus_thread></div><script type=text/javascript>/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'golang-code-examples'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class=footer><div class=contact><div id=name-gravatar class=float-left><span>By Lex Sheehan</span> <span class=l3x-gravatar></span></div><div class=float-right><strong>It's Go Time!</strong></div></div></div><div class=license-notice>The content of this site is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons 3.0License</a> and code is licensed under a <a href=https://github.com/l3x/golang-code-examples/blob/master/LICENSE>BSD license</a></div></div><script src=/golang-code-examples/scripts/scripts.db44.js></script></body></html>
